<h4 class="mb-3">Available Fruits</h4>
<div class="row">
  <div *ngFor="let f of fruits" class="col-md-4 mb-3">
    <div class="card card-fruit h-100">
      <img [src]="f.image || 'assets/images/placeholder.svg'" 
           [alt]="f.name" 
           class="card-img-top" 
           style="height:180px;object-fit:cover;"
           (error)="onImageError($event)">
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ f.name }}</h5>
        <p class="text-muted mb-1">₹{{ f.price }} • {{ f.quantity }} pcs</p>
        <p class="small text-secondary">{{ f.description }}</p>
        <div class="mt-auto d-flex justify-content-between align-items-center">
          <button class="btn btn-outline-success btn-sm" (click)="goEdit(f.id!)" [disabled]="!f.id">Details</button>
          
          <!-- Add to Cart Button - Only show for logged in users -->
          <div class="cart-controls">
            <!-- Not logged in -->
            <button 
              *ngIf="!isLoggedIn()" 
              class="btn btn-outline-secondary btn-sm" 
              (click)="addToCart(f, $event)"
              title="Please login to add to cart">
              <i class="fas fa-lock me-1"></i>Login to Add
            </button>
            
            <!-- Logged in but item not in cart -->
            <button 
              *ngIf="isLoggedIn() && f.id && !isInCart(f.id)" 
              class="btn btn-success btn-sm add-to-cart-btn" 
              (click)="addToCart(f, $event)">
              <i class="fas fa-cart-plus me-1"></i>Add to Cart
            </button>
            
            <!-- Logged in and item in cart -->
            <div *ngIf="isLoggedIn() && f.id && isInCart(f.id)" class="cart-quantity-badge">
              <span class="badge bg-success">
                <i class="fas fa-check me-1"></i>In Cart ({{ getCartQuantity(f.id) }})
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
